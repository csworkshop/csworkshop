<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="../bower_components/grid-element/grid-element.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/paper-styles/typography.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="md-viewer.html">

<dom-module id="tutorial-viewer">
  <template>
    <style include="shared-styles">
      :host {
        --paper-tab-ink: var(--paper-red-200);
      }
      paper-material {
        padding: 16px;
        border-radius: 2px;
        margin: auto auto 16px auto;
        background: white;
      }
      paper-tabs {
        background-color: var(--paper-blue-900);
        color: #fff;
        --paper-tabs-selection-bar-color: var(--paper-red-700);
      }
      paper-fab {
        float: right;
        background-color: var(--paper-blue-900);
        color: white;
        margin-bottom: 40px;
      }
    </style>

    <iron-ajax auto on-response="handleResponse" url="[[url]]" handle-as="text">
    </iron-ajax>

    <paper-material elevation="1">
      <h1>{{data.title}}</h1>
      <md-viewer url="{{data.url}}"></md-viewer>
    </paper-material>

    <paper-tabs scrollable fit-container selected="{{tabSelected}}" id="mySelector">
      <template is="dom-repeat" items="{{data.pages}}">
        <paper-tab>{{item.title}}</paper-tab>
      </template>
    </paper-tabs>

    <paper-material elevation="1">
      <iron-pages selected="{{tabSelected}}">
        <template is="dom-repeat" items="{{data.pages}}">
          <div>
            <md-viewer url="{{item.url}}"></md-viewer>
          </div>
        </template>
      </iron-pages>
      <paper-fab on-tap="handleTap" icon="chevron-right"></paper-fab>
    </paper-material>

  </template>

  <script>
    Polymer({
      is: 'tutorial-viewer',
      properties: {
        tabSelected: Number,
        url: String
      },
      ready: function () {
        this.tabSelected = 0;
      },
      handleResponse: function (e, request) {
        this.data = JSON.parse(request.response);
      },

      handleTap: function () {
        this.$.mySelector.selectNext();

        var scaffold = document.querySelector('core-scaffold');
        var scrollArea = scaffold.shadowRoot.querySelector('core-header-panel');
        scrollArea.scroller.scrollTop = 0; // Scroll to top
      }
    });
  </script>
</dom-module>

</script>
</dom-module>